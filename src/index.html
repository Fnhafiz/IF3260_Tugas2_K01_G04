<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="row">
        <canvas id="glcanvas">
            Oops ... your browser doesn't support the HTML5 canvas element
        </canvas>
        <div class="action-bar">
            <h3>Object</h3>
            <div>
                <label for="object">Object Type:</label>
                <input type="radio" name="object" value="cube" id="cube" checked>
                <label for="cube">Cube</label>
                <input type="radio" name="object" value="confusing" id="confusing">
                <label for="confusing">Confusing</label>
                <input type="radio" name="object" value="multiple" id="multiple">
                <label for="multiple">Multiple</label>
                <button onclick="changeObject()">Change</button>
                <br>
                <label for="shading">Shading: </label>
                <input type="checkbox" id="shading" name="shading" value="shading" onclick="drawScene();">
            </div>
            <br>

            <h3>Projection</h3>
            <div>
                <label for="projection">Projection Type:</label>
                <input type="radio" name="projection" value="orthographic" checked>Orthographic
                <input type="radio" name="projection" value="oblique">Oblique
                <input type="radio" name="projection" value="perspective">Perspective
                <button onclick="changeProjection()">Change</button>
            </div>
            <br>

            <h3>Change Object</h3>
            <div>
                <label for="rotationX">Rotate X:</label>
                <input type="range" name="rotationX" min="-180" max="180" value="0" id="rotationX"
                    oninput="slideRotate(0, this)">
                <output>0</output>

                <label for="rotationY">Rotate Y:</label>
                <input type="range" name="rotationY" min="-180" max="180" value="0" id="rotationY"
                    oninput="slideRotate(1, this)">
                <output>0</output>

                <label for="rotationZ">Rotate Z:</label>
                <input type="range" name="rotationZ" min="-180" max="180" value="0" id="rotationZ"
                    oninput="slideRotate(2, this)">
                <output>0</output>
            </div>
            <br>

            <div>
                <label for="translationX">Translation X:</label>
                <input type="range" name="translationX" min="-100" max="100" value="0" id="translationX"
                    oninput="slideTranslate(0, this)">
                <output>0</output>

                <label for="translationY">Translation Y:</label>
                <input type="range" name="translationY" min="-100" max="100" value="0" id="translationY"
                    oninput="slideTranslate(1, this)">
                <output>0</output>

                <label for="translationZ">Translation Z:</label>
                <input type="range" name="translationZ" min="-100" max="100" value="0" id="translationZ"
                    oninput="slideTranslate(2, this)">
                <output>0</output>
            </div>
            <br>

            <div>
                <label for="scalingX">Scale X:</label>
                <input type="range" name="scalingX" min="0" max="5" value="1" step="0.1" id="scalingX"
                    oninput="slideScale(0, this)">
                <output>1</output>

                <label for="scalingY">Scale Y:</label>
                <input type="range" name="scalingY" min="0" max="5" value="1" step="0.1" id="scalingY"
                    oninput="slideScale(1, this)">
                <output>1</output>

                <label for="scalingZ">Scale Z:</label>
                <input type="range" name="scalingZ" min="0" max="5" value="1" step="0.1" id="scalingZ"
                    oninput="slideScale(2, this)">
                <output>1</output>

                <br>

                <label for="scalingXYZ">Scale:</label>
                <input type="range" name="scalingZ" min="0" max="5" value="1" step="0.1" id="scalingXYZ"
                    oninput="slideScaleAll(this)">
                <output>1</output>
            </div>
            <br>

            <h3>Camera</h3>
            <div>
                <label for="cam-angle">Angle:</label>
                <input type="range" name="cam-angle" min="0" id="cam-angle" max="360" value="0"
                    oninput="camAngle(this)">
                <output>0</output>

                <label for="cam-zoom">Zoom:</label>
                <input type="range" name="cam-zoom" min="0" id="cam-zoom" max="3" step="0.05" value="1"
                    oninput="camZoom(this)">
                <output>1</output>
            </div>
            <br>

            <div>
                <label for="fieldOfView">Field of View:</label>
                <input type="range" name="fieldOfView" min="1" max="179" value="1" id="fieldOfView"
                    oninput="updateFieldOfView(this)">
                <output>0</output>
            </div>
            <br>

            <h3>Load/Save</h3>
            <div>
                <input type="text" id="filename" placeholder="Enter Title Here">
                <button id="save">Save</button>
                <br>
                <input type="file" id="loadfile" accept=".json, application/json">
                <br>
                <label for="multiple-load">Load Multiple Model: </label>
                <input type="checkbox" id="multiple-load" name="multiple-load" value="multiple-load">
            </div>
            <br>

            <div>
                <input type="button" id="reset" name="reset" value="Reset" onclick="reset()">
                <input type="button" id="help" name="help" value="Help">
            </div>
        </div>
    </div>

</body>

<script>
    var vertices = [];
    var objects = [];

    const canvas = document.querySelector('#glcanvas');
    canvas.width = 600;
    canvas.height = 400;

    // Initialize the GL context
    const gl = canvas.getContext('webgl');

    if (!gl) {
        alert('Unable to initialize WebGL. Your browser or machine may not support it.');
    }

    // Vertex shader source code
    var vertCode = `
            attribute vec3 position;
            attribute vec3 color;
            attribute vec3 normal;

            uniform mat4 Pmatrix;
            uniform mat4 Vmatrix;
            uniform mat4 Mmatrix;
            uniform mat4 Nmatrix;

            varying vec3 vLighting;
            varying vec3 vColor;

            void main(void) {
                gl_Position = Pmatrix*Vmatrix*Mmatrix*vec4(position, 1.);
                vec3 ambientLight = vec3(0.3, 0.3, 0.3);
                vec3 directionalLightColor = vec3(1, 1, 1);
                vec3 directionalVector = normalize(vec3(0.85, 0.8, 0.75));
                vec4 transformedNormal = Nmatrix*vec4(normal, 1.);

                float directional = max(dot(transformedNormal.xyz, directionalVector), 0.0);
                vLighting = ambientLight + (directionalLightColor * directional);
                vColor = color;
            }
            `;

    // Create a vertex shader object
    var vertShader = gl.createShader(gl.VERTEX_SHADER);

    // Fragment shader source code
    var fragCode = `precision mediump float;
        varying vec3 vColor; 
        varying vec3 vLighting;
        void main(void) {
            gl_FragColor = vec4(vColor, 1.);
            gl_FragColor.rgb *= vLighting;
        }`;

    // Create fragment shader object
    var fragShader = gl.createShader(gl.FRAGMENT_SHADER);

    // Create a shader program object to store
    var shaderProgram = gl.createProgram();

    function setupShader() {
        // Attach vertex shader source code
        gl.shaderSource(vertShader, vertCode);
        // Compile the vertex shader
        gl.compileShader(vertShader);
        // Attach fragment shader source code
        gl.shaderSource(fragShader, fragCode);
        // Compile the fragmentt shader
        gl.compileShader(fragShader);
    }

    function setupProgram() {
        // Attach a vertex shader
        gl.attachShader(shaderProgram, vertShader);
        // Attach a fragment shader
        gl.attachShader(shaderProgram, fragShader);
        // Link both the programs
        gl.linkProgram(shaderProgram);
    }

    setupShader();
    setupProgram();
</script>
<script type="text/javascript" src="script/math.js"></script>
<script type="text/javascript" src="script/matrixOperator.js"></script>
<script type="text/javascript" src="script/confusing.js"></script>
<script type="text/javascript" src="script/cube.js"></script>
<script type="text/javascript" src="script/shading.js"></script>
<script type="text/javascript" src="script/script.js"></script>
<script type="text/javascript" src="script/function.js"></script>

</html>